---
title: 'Estudo de caso: Grupo D 3'
author: "Gilmar and Maressa Nunes R. Tavares and Victor"
date: "3 de Setembro, 2019"
output:
  pdf_document:
    fig_caption: yes
    number_sections: yes
  html_document:
    df_print: paged
csl: ieee.csl
bibliography: refsCS02.bib
---

```{r setup,results='hide',warning=FALSE,echo=FALSE, message=FALSE, include=FALSE}
# A few initial definitions just to make sure all required packages are installed. Change as needed.
# NOTE: It may echo some weird messages to the PDF on the first compile (package installation messages). Run twice and the problem will (hopefully) go away.
if (!require(ggplot2, quietly = TRUE)){
      install.packages("ggplot2")
      }
if (!require(devtools, quietly = TRUE)){
      install.packages("devtools")
      }
 if (!require(broom, quietly = TRUE)){
       devtools::install_github("dgrtwo/broom")
      }
if (!require(GGally, quietly = TRUE)){
      install.packages("GGally")
}

if (!require(ExpDE, quietly = TRUE)){
  install.packages("ExpDE")
}

if (!require(car, quietly = TRUE)){
  install.packages("car")
}

if (!require(boot, quietly = TRUE)){
  install.packages("boot")
}

if (!require(dplyr, quietly = TRUE)){
  install.packages("boot")
}

```

# Summary


# Planejamento do experimento


## Objetivo do experimento


$$\begin{cases} H_0: \mu = 50&\\H_1: \mu<50\end{cases}$$

$$\begin{cases} H_0: \sigma^{2} = 100&\\H_1: \sigma^{2} < 100\end{cases}$$


### Descrição da coleta de dados


### Descrição da coleta de dados

```{r datapreprocessing}
imc <- function(height, weight){
  return(weight/(height^2))
}

data.2016.2 <- read.csv('imc_20162.csv', header = T, sep = ",")
data.2017.2 <- read.csv('CS01_20172.csv', header = T, sep = ";")
data.2017.2 <- data.2017.2 %>% rename(Gender = Sex)

# calculate the IMC
data.2016.2$imc <- imc(data.2016.2$Height.m, data.2016.2$Weight.kg)
data.2017.2$imc <- imc(data.2017.2$height.m, data.2017.2$Weight.kg)

# remove undergraduate students for 2016.2 data
data.2016.2 <- data.2016.2 %>% filter(Course == 'PPGEE')

# remove unecessary columns and rename
data.2016.2 <- data.2016.2 %>% select(Gender, imc)
data.2017.2 <- data.2017.2 %>% select(Gender, imc)

# split the 2016.2 data by gender and remove undergraduate students
data.2016.2.Females <- data.2016.2 %>% filter(Gender == 'F') %>% select(imc)
data.2016.2.Males <- data.2016.2 %>% filter(Gender == 'M') %>% select(imc)

# split the 2017.2 data by gender
data.2017.2.Females <- data.2017.2 %>% filter(Gender == 'F') %>% select(imc)
data.2017.2.Males <- data.2017.2 %>% filter(Gender == 'M') %>% select(imc)

```


# Análise Exploratória dos Dados





# Resultados

## Validação das premissas

Para realizar as inferências estatísticas sobre o IMC das duas populações é necessário validar as premissas antes de executar o teste. Neste caso, como as variâncias das duas populações é desconhecida, utiliza-se a distribuição t para o teste de hipóteses e para os intervalos de confiança [@montgomery2007applied]. A seguir são apresentados os testes realizados para validar as premissas exigidas pelo teste t.

1 - Normalidade: 

Para avaliar a normalidade dos dados das duas populações utilizou-se o gráfico quantil-quantil e o teste de Shapiro Wilk com $\alpha = 0.05$

```{r plot_boxplot, echo=FALSE, fig.width=7,fig.height=4, fig.cap="Gráfico quantil-quantil das populações"}
par(mfrow=c(1,2))

library(car)
qqPlot(data.2016.2$imc, dist='norm',envelope=.95, las = 1, pch = 16, main="Normal Q -Q plot")
#qqline(data.2016.2$imc)

```


```{r shapiro}
shapiro.test(data.2016.2$imc)
```
Pela análise do teste de Shapiro-Wilk e do gráfico concluímos que há evidências de que os dados de 2016.2 não são normalmente distribuídos, pois o pvalordo teste de Shapiro Wilk foi menor que 0.05. 

```{r plot_boxplot1, echo=FALSE, fig.width=7,fig.height=4, fig.cap="Gráfico quantil-quantil das populações"}
par(mfrow=c(1,2))

library(car)
qqPlot(data.2017.2$imc, dist='norm', envelope=.95, las = 1, pch = 16, main="Normal Q -Q plot")
```

```{r shapiro1}
shapiro.test(data.2017.2$imc)
```
Por outro lado, não há evidências para rejeitar a normalidade dos dados de IMC coletados em 2017.2, pois p-valor foi maior que 0.05 (p-value = 0.3049); fato este que pode ser observado também no gráfico.

2- Igualdade de Variâncias:

A segunda premissa a ser avaliada é a igualdade de variâncias das duas populações, homocedasticidade. Para tanto, utilizou-se o teste F com a função var.test e $\alpha = 0.05$, que tem como hipótese nula a igualdade da variância das duas amostras.

``` {r vartes}
var.test(data.2016.2$imc,data.2017.2$imc)
```
Pelo teste F conclui-se que não há evidências para rejeitar a hipótese nula de igualdade das variâncias da população duas populações, portanto, as duas amostras são homocedásticas.

3 - Independência

Considerando que as populações referem-se a dois grupos distintos da pós-graduação, sabe-se a priori, que as amostras são independentes. Para concluir em relação à independência realizou-se o teste Qui-quadrado com $\alpha = 0.05$.

``` {r chitest}
data <- c(data.2016.2$imc, data.2017.2$imc)
chisq.test(data)
```
Como era esperado, o teste Qui-quadrado reafirma a independência entre as duas amostras, como o pvalor = 0.9565.

## Teste do custo médio

### Teste da variância do custo

# Análise Estatística
## Teste sobre a média do custo
### Cálculo do tamanho amostral

### Teste de Hipoteses
### Calculo do intervalo de confianca
### Validaçao das premissas

## Teste sobre a variância do custo
### Teste de Hipoteses
### Calculo do intervalo de confianca
### Validaçao das premissas

# Discussão e Conclusões

# Divisão das Atividades

Victor - Reporter
Maressa - Coordenadora
Gilmar - Verificador e Monitor

















# Referências



